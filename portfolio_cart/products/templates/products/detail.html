{% extends "base.html" %}
{% load static %}
{% block content %}
<section class="header_text sub">
<img class="pageBanner" src="{% static 'themes/images/pageBanner.png' %}" alt="New products" >
	<h4><span>Product Detail</span></h4>
</section>
<section class="main-content">
	<div class="row">
		<div class="span9">
			<div class="row">
				<div class="span4">
					<a href="{{ product.image_set.first.file.url }}" class="thumbnail" data-fancybox-group="group1" title="{{ product.image_set.first.description }}"><img alt="" src="{{ product.image_set.first.file.url }}"></a>
					<ul class="thumbnails small">
    				{% for image in product.image_set.all|slice:"1:" %}
						<li class="span1">
							<a href="{{ image.file.url }}" class="thumbnail" data-fancybox-group="group1" title="{{ image.description }}"><img src="{{ image.file.url }}" alt=""></a>
						</li>
					{% endfor %}
					</ul>
				</div>
				<div class="span5">
					<h4><strong>價錢: ${{ product.price }}</strong></h4>
				</div>
				<div class="span5">
					<form class="form-inline">
						<label>Qty:</label>
						<select id="add_quantity">
    					{% for i in stock_range %}
							<option value="{{ forloop.counter }}">{{ forloop.counter }}</option>
						{% endfor %}
						</select>
						<button id="submit" class="btn btn-inverse" type="button">Add to cart</button>
					</form>
				</div>
				<script type="text/javascript">
					function getCookie(name) {
						let cookieValue = null;
						if (document.cookie && document.cookie !== '') {
							const cookies = document.cookie.split(';');
							for (let i = 0; i < cookies.length; i++) {
								const cookie = cookies[i].trim();
								// Does this cookie string begin with the name we want?
								if (cookie.substring(0, name.length + 1) === (name + '=')) {
									cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
									break;
								}
							}
						}
						return cookieValue;
					}
					const csrftoken = getCookie('csrftoken');
					function csrfSafeMethod(method) {
						// these HTTP methods do not require CSRF protection
						return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
					}
					$.ajaxSetup({
						beforeSend: function(xhr, settings) {
							if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
								xhr.setRequestHeader("X-CSRFToken", csrftoken);
							}
						},
						url: "{% url 'cart:add' %}",
						type: "POST"
					});
					$(document).ready(function(){
						$("#submit").click(function(){
							var quantity = $("#add_quantity").val();
							$.ajax({
								data: {
									"product_id": {{ product.id }},
									"quantity": quantity,
								}
							}).done(function(data) {
								alert(data.message);
							}).fail(function() {
								alert("error");
							});
						});
					});
				</script>
			</div>
			<div class="row">
				<div class="span9">
					<ul class="nav nav-tabs" id="myTab">
						<li class="active"><a href="#home">Description</a></li>
					</ul>
					<div class="tab-content">
						<div class="tab-pane active" id="home">{{ product.description|linebreaks }}</div>
					</div>
				</div>
				<div class="span9">
					<br>
					<h4 class="title">
						<span class="pull-left"><span class="text"><strong>Related</strong> Products</span></span>
						<span class="pull-right">
							<a class="left button" href="#myCarousel-1" data-slide="prev"></a><a class="right button" href="#myCarousel-1" data-slide="next"></a>
						</span>
					</h4>
					<div id="myCarousel-1" class="carousel slide">
						<div class="carousel-inner">
							<div class="active item">
								<ul class="thumbnails listing-products">
									<li class="span3">
										<div class="product-box">
											<span class="sale_tag"></span>
											<a href="product_detail.html"><img alt="" src="{% static 'themes/images/ladies/6.jpg' %}"></a><br/>
											<a href="product_detail.html" class="title">Wuam ultrices rutrum</a><br/>
											<a href="#" class="category">Suspendisse aliquet</a>
											<p class="price">$341</p>
										</div>
									</li>
									<li class="span3">
										<div class="product-box">
											<span class="sale_tag"></span>
											<a href="product_detail.html"><img alt="" src="{% static 'themes/images/ladies/5.jpg' %}"></a><br/>
											<a href="product_detail.html" class="title">Fusce id molestie massa</a><br/>
											<a href="#" class="category">Phasellus consequat</a>
											<p class="price">$341</p>
										</div>
									</li>
									<li class="span3">
										<div class="product-box">
											<a href="product_detail.html"><img alt="" src="{% static 'themes/images/ladies/4.jpg' %}"></a><br/>
											<a href="product_detail.html" class="title">Praesent tempor sem</a><br/>
											<a href="#" class="category">Erat gravida</a>
											<p class="price">$28</p>
										</div>
									</li>
								</ul>
							</div>
							<div class="item">
								<ul class="thumbnails listing-products">
									<li class="span3">
										<div class="product-box">
											<span class="sale_tag"></span>
											<a href="product_detail.html"><img alt="" src="{% static 'themes/images/ladies/1.jpg' %}"></a><br/>
											<a href="product_detail.html" class="title">Fusce id molestie massa</a><br/>
											<a href="#" class="category">Phasellus consequat</a>
											<p class="price">$341</p>
										</div>
									</li>
									<li class="span3">
										<div class="product-box">
											<a href="product_detail.html"><img alt="" src="{% static 'themes/images/ladies/2.jpg' %}"></a><br/>
											<a href="product_detail.html">Praesent tempor sem</a><br/>
											<a href="#" class="category">Erat gravida</a>
											<p class="price">$28</p>
										</div>
									</li>
									<li class="span3">
										<div class="product-box">
											<span class="sale_tag"></span>
											<a href="product_detail.html"><img alt="" src="{% static 'themes/images/ladies/3.jpg' %}"></a><br/>
											<a href="product_detail.html" class="title">Wuam ultrices rutrum</a><br/>
											<a href="#" class="category">Suspendisse aliquet</a>
											<p class="price">$341</p>
										</div>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="span3 col">
			<div class="block">
				<h4 class="title">
					<span class="pull-left"><span class="text">Randomize</span></span>
					<span class="pull-right">
						<a class="left button" href="#myCarousel" data-slide="prev"></a><a class="right button" href="#myCarousel" data-slide="next"></a>
					</span>
				</h4>
				<div id="myCarousel" class="carousel slide">
					<div class="carousel-inner">
						<div class="active item">
							<ul class="thumbnails listing-products">
								<li class="span3">
									<div class="product-box">
										<span class="sale_tag"></span>
										<a href="product_detail.html"><img alt="" src="{% static 'themes/images/ladies/7.jpg' %}"></a><br/>
										<a href="product_detail.html" class="title">Fusce id molestie massa</a><br/>
										<a href="#" class="category">Suspendisse aliquet</a>
										<p class="price">$261</p>
									</div>
								</li>
							</ul>
						</div>
						<div class="item">
							<ul class="thumbnails listing-products">
								<li class="span3">
									<div class="product-box">
										<a href="product_detail.html"><img alt="" src="{% static 'themes/images/ladies/8.jpg' %}"></a><br/>
										<a href="product_detail.html" class="title">Tempor sem sodales</a><br/>
										<a href="#" class="category">Urna nec lectus mollis</a>
										<p class="price">$134</p>
									</div>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="block">
				<h4 class="title"><strong>Best</strong> Seller</h4>
				<ul class="small-product">
					<li>
						<a href="#" title="Praesent tempor sem sodales">
							<img src="{% static 'themes/images/ladies/1.jpg' %}" alt="Praesent tempor sem sodales">
						</a>
						<a href="#">Praesent tempor sem</a>
					</li>
					<li>
						<a href="#" title="Luctus quam ultrices rutrum">
							<img src="{% static 'themes/images/ladies/2.jpg' %}" alt="Luctus quam ultrices rutrum">
						</a>
						<a href="#">Luctus quam ultrices rutrum</a>
					</li>
					<li>
						<a href="#" title="Fusce id molestie massa">
							<img src="{% static 'themes/images/ladies/3.jpg' %}" alt="Fusce id molestie massa">
						</a>
						<a href="#">Fusce id molestie massa</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
</section>
{% endblock %}